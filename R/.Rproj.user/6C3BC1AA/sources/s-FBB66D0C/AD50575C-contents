#
# This is the user-interface definition of a Shiny web application. You can
# run the application by clicking 'Run App' above.
#
# Find out more about building applications with Shiny here:
#
#    http://shiny.rstudio.com/
#

library(shiny)
require(visNetwork)


fluidPage(
  titlePanel("scPPIN-online"),
  sidebarPanel(
    numericInput("log10FDR", "log10(False Discovery Rate):", min = -100, max = -1, value = -2),
    helpText("The higher the FDR, the longer the",
             "computation time. Start with small values",
             "(approximately smallest p-value in list)"),
    br(),
    selectInput("organism", "Organism",c("Homo sapiens", "Mus musculus")),
    # Input: Select a file ----
    fileInput("pValFile", "Differential expression p-values (CSV, [example])",
              multiple = FALSE,
              accept = c("text/csv",
                         "text/comma-separated-values,text/plain",
                         ".csv")),
    actionButton("goButton", "Compute!")
  ),

  mainPanel(
    tabsetPanel(type = "tabs",
                tabPanel("Interactive illustration",
                         visNetworkOutput("network"),
                         p("Red boxes indicate proteins with p-values above the FDR. Scroll to zoom in and out.")
                ),
                tabPanel("Edge list ",
                         tableOutput("table")
                ),
                # tabPanel("Static Image", plotOutput("plot"),
                #          p("Nodes shown as squares and with red labels have a p-value below the chosen FDR.")
                # ),
                tabPanel("Download result",
                         downloadButton("scPPIN_DownloadGraphML", "Download GraphML File"),
                         br(),
                         downloadButton("scPPIN_DownloadEdgeList", "Download Edge List")

                ),
                tabPanel("About scPPIN",
                         h4("Active module detection in protein--protein interaction networks"),
                         p("The webtool scPPIN-online allows you to find active modules in protein--protein interaction networks (PPINs). It performs the following steps:"),
                         HTML("<ol><li> taking p-values of differential expressions for a list of genes (e.g., marker genes of a cell cluster as identified in a single-cell RNA-seq experiment), </li>
                              <li> integrating this data with a PPIN by constructing a node-weighted network, and</li>
                              <li> computing a maximum-weight connected subgraph.</li>
                              </ol>"),
                         p("The organism determines which PPIN scPPIN uses. For all supported organisms we constructed PPINs from protein interaction data from BioGRID."),
                         br(),
                         p("For details see our preprint [LINK]."),
                         br(),
                         p("The R library scPPIN with more options is available on [GitHub]."),
                         br(),
                         img(src="./opig_logo.png", align = "center"),
                         p("Webapp developed by Florian Klimm (Oxford Protein Informatics Group)")
                         #HTML(`<img src="./data/opig_logo.png"/>'')
                )
    )


  )







)
















# fluidPage(
#   headerPanel("scPPIN-online"),
#   sidebarPanel(
#     numericInput("log10FDR", "log10(False Discovery Rate):", min = -100, max = -1, value = -2),
#     br(),
#     selectInput("organism", "Organism",c("Homo sapiens", "Mus musculus")),
#     # Input: Select a file ----
#     fileInput("pValFile", "Choose CSV File",
#               multiple = FALSE,
#               accept = c("text/csv",
#                          "text/comma-separated-values,text/plain",
#                          ".csv")),
#     actionButton("goButton", "Go!"),
#     p("Click the button to run scPPIN for the selected input.")
#   ),
#
#   tabsetPanel(type = "tabs",
#     tabPanel("Edge List ",
#              tableOutput("table")
#     ),
#     tabPanel("Interactive illustration",
#              visNetworkOutput("network"),
#              p("Red squares indicate proteins above the FDR. Scroll to zoom in and out.")
#     ),
#     # tabPanel("Static Image", plotOutput("plot"),
#     #          p("Nodes shown as squares and with red labels have a p-value below the chosen FDR.")
#     # ),
#     tabPanel("Download Result",
#              downloadButton("scPPIN_DownloadGraphML", "Download GraphML File"),
#              downloadButton("scPPIN_DownloadEdgeList", "Download Edge List")
#
#     )
#   ),
#   mainPanel(
#
#   )
#
#
#
#
#
#
# )
